<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wdelivery.member.dao.MemberDAO">
	<select id="findUser" resultType="userVO" parameterType="userVO">
		<![CDATA[
			select * from user_info where user_email = #{user_email}
		]]>
	</select>
	
	<insert id="winMemJoin">
		<![CDATA[
			insert into user_info (user_email, user_password, user_name, user_gender, user_phone, terms_agree, user_agreedate, sms_agree, email_agree, user_birth,user_regdate,user_status) 
			values (#{user_email},#{user_password},#{user_name},#{user_gender},#{user_phone},#{terms_agree},now(),#{sms_agree},#{email_agree},#{user_birth},now(),3)
		]]>
	</insert>
	
	<insert id="winAddressJoin">
		<![CDATA[
			insert into user_address(user_email, address1, address2,d_key) values (#{user_email},#{address1},#{address2},1)
		]]>
	</insert>
	

	<select id="userSelect" resultType="userVO" parameterType="userVO">
		<![CDATA[
			select * from user_info where user_email = #{user_email}	
		]]>
	</select>
	<update id="mypageUpdate">
		<![CDATA[
		update user_info
		set user_name = #{user_name}, user_phone = #{user_phone}, user_password = #{user_password}
		where user_seq = #{user_seq}
		]]>
	</update>

	<select id="emailChk" resultType="int" parameterType="userVO">
		<![CDATA[
			select count(*) from user_info where user_email = #{user_email};
		]]>
	</select>
	
	<insert id="insertAuthData" parameterType="userVO">
	<![CDATA[
			insert into authkey(user_email) values (#{user_email})
		]]>
	</insert>
	<update id="updateAuthKey" parameterType="java.util.HashMap">
	<![CDATA[
			update authkey set auth_key = #{authKey} where user_email = #{user_email}
		]]>
	</update>
	
	<update id="signUpConfirm" parameterType="String">
	<![CDATA[
			update user_info set user_status = 1 where user_email = #{user_email}
		]]>
	</update>
	
	<select id="isAuthKeyAvailable" resultType="int"  parameterType="java.util.HashMap">
		<![CDATA[
			select count(*) from authkey where user_email = #{email} and auth_key = #{authKey}
		]]>
	</select>
</mapper>